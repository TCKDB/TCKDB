"""
TCKDB backend app tests schemas test_species module
"""

import os
import pytest
from pydantic import ValidationError

from tckdb import tckdb_path
from tckdb.backend.app.schemas.species import SpeciesBase
from tckdb.backend.app.conversions import read_yaml_file


DATA_PATH = os.path.join(tckdb_path, 'tckdb', 'backend', 'app', 'tests', 'schemas', 'data')


def test_species_schema():
    """Test creating an instance of Species"""

    # shared data
    h_xyz = {'symbols': ('H',),
             'isotopes': (1,),
             'coords': ((0.0, 0.0, 0.0),)}
    ch4_xyz = {'symbols': ('C', 'H', 'H', 'H', 'H'),
               'isotopes': (12, 1, 1, 1, 1),
               'coords': ((0.0, 0.0, 0.0),
                          (0.6300326, 0.6300326, 0.6300326),
                          (-0.6300326, -0.6300326, 0.6300326),
                          (-0.6300326, 0.6300326, -0.6300326),
                          (0.6300326, -0.6300326, -0.6300326))}
    ch4_freqs = [3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368, 1368]
    ch4_scaled_freqs = [3046 * .99, 1555 * .99, 1555 * .99, 3168 * .99, 3168 * .99, 3168 * .99, 1368 * .99, 1368 * .99,
                        1368 * .99]
    ch4_normal_disp_modes = [[[1, 2, 3]] * 5] * 9
    ICdCC_Cl__I_NF_xyz = {'symbols': ('I', 'I', 'Cl', 'F', 'N', 'C', 'C', 'C', 'H', 'H', 'H'),
                          'isotopes': (127, 127, 35, 19, 14, 12, 12, 12, 1, 1, 1),
                          'coords': ((-0.1752057997244146, 2.579412243969442, -0.0998868241437122),
                                     (2.982861260942898, -2.085955126671259, -0.45379679871721257),
                                     (-1.134251085086272, 0.5188212354137014, 2.0757032605524133),
                                     (-1.8814930376300307, -1.2539895001453651, -0.2064584290134856),
                                     (-1.5494242545791568, 0.0648586431861974, -0.452378816320353),
                                     (-0.48883763038476624, 0.5436231953516003, 0.41802210133854123),
                                     (0.8221194714634887, -0.18495290937918607, 0.3615122853791793),
                                     (1.1541030666741987, -1.1716982225873687, -0.4863411908291395),
                                     (1.5573291340285325, 0.13404869476412778, 1.0992045049933756),
                                     (-2.353154400199601, 0.664646058045691, -0.27667502002715677),
                                     (0.4586997381222457, -1.5322585343327426, -1.2389102050458707))}
    ICdCC_Cl__I_NF_freqs = [i + 1 for i in range(27)]
    ICdCC_Cl__I_NF_scaled_freqs = [(i + 1) * 0.973 for i in range(27)]
    ICdCC_Cl__I_NF_normal_disp_modes = [[[1, 2, 3]] * 11] * 27

    # 1. descriptors
    # only providing SMILES
    spc_1 = SpeciesBase(smiles='C',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_1.smiles == 'C'
    assert spc_1.inchi == 'InChI=1S/CH4/h1H4'
    assert spc_1.inchi_key == 'VNWKTOKETHGBQD-UHFFFAOYSA-N'
    assert spc_1.graph == """1 C u0 p0 c0 {2,S} {3,S} {4,S} {5,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
4 H u0 p0 c0 {1,S}
5 H u0 p0 c0 {1,S}
"""
    # only providing InChI
    spc_2 = SpeciesBase(inchi='InChI=1S/CH4/h1H4',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_2.smiles == 'C'
    assert spc_2.inchi == 'InChI=1S/CH4/h1H4'
    assert spc_2.inchi_key == 'VNWKTOKETHGBQD-UHFFFAOYSA-N'
    assert spc_2.graph == """1 C u0 p0 c0 {2,S} {3,S} {4,S} {5,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
4 H u0 p0 c0 {1,S}
5 H u0 p0 c0 {1,S}
"""
    # only providing InChI Key
    spc_3 = SpeciesBase(inchi_key='VNWKTOKETHGBQD-UHFFFAOYSA-N',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_3.smiles == 'C'
    assert spc_3.inchi == 'InChI=1S/CH4/h1H4'
    assert spc_3.inchi_key == 'VNWKTOKETHGBQD-UHFFFAOYSA-N'
    assert spc_3.graph == """1 C u0 p0 c0 {2,S} {3,S} {4,S} {5,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
4 H u0 p0 c0 {1,S}
5 H u0 p0 c0 {1,S}
"""
    # only providing adjacency list
    spc_4 = SpeciesBase(graph="""1 C u0 p0 c0 {2,S} {3,S} {4,S} {5,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
4 H u0 p0 c0 {1,S}
5 H u0 p0 c0 {1,S}
""",
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_4.smiles == 'C'
    assert spc_4.inchi == 'InChI=1S/CH4/h1H4'
    assert spc_4.inchi_key == 'VNWKTOKETHGBQD-UHFFFAOYSA-N'
    assert spc_4.graph == """1 C u0 p0 c0 {2,S} {3,S} {4,S} {5,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
4 H u0 p0 c0 {1,S}
5 H u0 p0 c0 {1,S}
"""

    # 2. test correcting the adjlist multiplicity for a singlet, and not correcting for a triplet
    spc_5 = SpeciesBase(smiles='[N]=C=[N]',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_5.graph == """multiplicity 1
1 N u1 p1 c0 {2,D}
2 C u0 p0 c0 {1,D} {3,D}
3 N u1 p1 c0 {2,D}
"""
    spc_6 = SpeciesBase(smiles='[N]=C=[N]',
                        charge=0,
                        multiplicity=3,
                        coordinates=ch4_xyz,
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_6.graph == """multiplicity 3
1 N u1 p1 c0 {2,D}
2 C u0 p0 c0 {1,D} {3,D}
3 N u1 p1 c0 {2,D}
"""
    with pytest.raises(ValidationError):
        # multiplicity mismatch
        SpeciesBase(smiles='[N]=C=[N]',
                    charge=0,
                    multiplicity=2,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 3. fragments
    spc_7 = SpeciesBase(smiles='C',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        fragments=[[1, 2, 3], [4, 5]],
                        fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_7.fragments == [[1, 2, 3], [4, 5]]
    spc_8 = SpeciesBase(smiles='C',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        fragments=[[1, 2, 3, 4, 5]],
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_8.fragments is None  # one fragments translates to None
    with pytest.raises(ValidationError):
        # duplicate atom indices in fragments
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 1], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # fragments length does not match the number of atoms from the coordinates
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3, 6], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # 0-indexed atoms in fragments
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 0], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 3. fragment_orientation
    assert spc_7.fragment_orientation == [{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}]
    spc_9 = SpeciesBase(smiles='C',
                        charge=0,
                        multiplicity=1,
                        coordinates=ch4_xyz,
                        fragments=[[1, 2], [3], [4, 5]],
                        fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3},
                                              {'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                        external_symmetry=4,
                        point_group='Td',
                        conformation_method='ARC v1.1.0',
                        is_well=True,
                        electronic_energy=-365.544,
                        E0=-370.240,
                        hessian=[[1] * 15] * 15,
                        frequencies=ch4_freqs,
                        scaled_projected_frequencies=ch4_scaled_freqs,
                        normal_displacement_modes=ch4_normal_disp_modes,
                        freq_id=1,
                        rigid_rotor='spherical top',
                        statmech_treatment='RRHO',
                        rotational_constants=[1, 2, 3],
                        H298=-74.52,
                        S298=186.06,
                        Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                        Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                        en_corr_id=2,
                        opt_path='path/to/opt/job.log',
                        freq_path='path/to/freq/job.log',
                        sp_path='path/to/sp/job.log',
                        )
    assert spc_9.fragment_orientation == [{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3},
                                          {'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}]
    with pytest.raises(ValidationError):
        # not specifying fragments, but specifying fragment_orientation
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # not specifying fragment_orientation, but specifying fragments
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3], [4, 5]],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # wring length of fragment_orientation
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2], [3], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # extra keys in fragment_orientation
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'z': 3, 'key': 5}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # invalid key fragment_orientation
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': 1, 'y': 2, 'zed': 5}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # wrong value type for 'cm' key
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3], [4, 5]],
                    fragment_orientation=[{'cm': 7, 'x': 1, 'y': 2, 'z': 5}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # wrong vector length for 'cm' key
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3, 4], 'x': 1, 'y': 2, 'z': 5}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # wrong value type for 'x' key
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    fragments=[[1, 2, 3], [4, 5]],
                    fragment_orientation=[{'cm': [1, 2, 3], 'x': [1, 4], 'y': 2, 'z': 5}],
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 4. point_group
    assert spc_9.point_group == 'Td'
    spc_10 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=1,
                         point_group='Cinfv',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_10.point_group == 'Cinfv'
    spc_11 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=1,
                         point_group='D4',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_11.point_group == 'D4'
    spc_12 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=1,
                         point_group='Oh',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_12.point_group == 'Oh'
    spc_13 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=1,
                         point_group='I',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_13.point_group == 'I'
    spc_14 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=1,
                         point_group='C6',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_14.point_group == 'C6'
    with pytest.raises(ValidationError):
        # wrong first char for point group
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=1,
                    point_group='a6',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # wrong last char for point group
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=1,
                    point_group='Ca',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # wrong length of point group
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=1,
                    point_group='C645448',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # unexpected char in point group
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=1,
                    point_group='Cx8',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 5. chirality
    spc_15 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=4,
                         point_group='Td',
                         chirality={(1,): 'R'},
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_15.chirality == {(1,): 'R'}
    spc_16 = SpeciesBase(smiles='IC=CC(Cl)(I)NF',
                         charge=0,
                         multiplicity=1,
                         coordinates=ICdCC_Cl__I_NF_xyz,
                         external_symmetry=1,
                         point_group='C1',
                         chirality={(5,): 'NR', (6,): 'R', (7, 8): 'E'},
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 33] * 33,
                         frequencies=ICdCC_Cl__I_NF_freqs,
                         scaled_projected_frequencies=ICdCC_Cl__I_NF_scaled_freqs,
                         normal_displacement_modes=ICdCC_Cl__I_NF_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='asymmetric top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=160.62,
                         S298=186.01,
                         Cp_values=[96.44, 115.77, 131.34, 143.47, 160.79, 171.46, 184.18],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_16.chirality == {(5,): 'NR', (6,): 'R', (7, 8): 'E'}
    with pytest.raises(ValidationError):
        # wrong atom index
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    chirality={(7,): 'R'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # not a carbon center
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    chirality={(2,): 'R'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # unsupported value
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    chirality={(1,): 'X'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # an `E` type for an atom center
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    chirality={(1,): 'E'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # an `S` type for a double bond chiral center
        SpeciesBase(smiles='IC=CC(Cl)(I)NF',
                    charge=0,
                    multiplicity=1,
                    coordinates=ICdCC_Cl__I_NF_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    chirality={(5,): 'NR', (6,): 'R', (7, 8): 'S'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 33] * 33,
                    frequencies=ICdCC_Cl__I_NF_freqs,
                    scaled_projected_frequencies=ICdCC_Cl__I_NF_scaled_freqs,
                    normal_displacement_modes=ICdCC_Cl__I_NF_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=160.62,
                    S298=186.01,
                    Cp_values=[96.44, 115.77, 131.34, 143.47, 160.79, 171.46, 184.18],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # three chiral centers
        SpeciesBase(smiles='IC=CC(Cl)(I)NF',
                    charge=0,
                    multiplicity=1,
                    coordinates=ICdCC_Cl__I_NF_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    chirality={(5,): 'NR', (6, 7, 8): 'E'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 33] * 33,
                    frequencies=ICdCC_Cl__I_NF_freqs,
                    scaled_projected_frequencies=ICdCC_Cl__I_NF_scaled_freqs,
                    normal_displacement_modes=ICdCC_Cl__I_NF_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=160.62,
                    S298=186.01,
                    Cp_values=[96.44, 115.77, 131.34, 143.47, 160.79, 171.46, 184.18],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # repeated atom index
        SpeciesBase(smiles='IC=CC(Cl)(I)NF',
                    charge=0,
                    multiplicity=1,
                    coordinates=ICdCC_Cl__I_NF_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    chirality={(5,): 'NR', (6,): 'R', (7, 6): 'E'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 33] * 33,
                    frequencies=ICdCC_Cl__I_NF_freqs,
                    scaled_projected_frequencies=ICdCC_Cl__I_NF_scaled_freqs,
                    normal_displacement_modes=ICdCC_Cl__I_NF_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=160.62,
                    S298=186.01,
                    Cp_values=[96.44, 115.77, 131.34, 143.47, 160.79, 171.46, 184.18],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # a non-nitrogen 'NR'
        SpeciesBase(smiles='IC=CC(Cl)(I)NF',
                    charge=0,
                    multiplicity=1,
                    coordinates=ICdCC_Cl__I_NF_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    chirality={(5,): 'NR', (6,): 'NR', (7, 8): 'E'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 33] * 33,
                    frequencies=ICdCC_Cl__I_NF_freqs,
                    scaled_projected_frequencies=ICdCC_Cl__I_NF_scaled_freqs,
                    normal_displacement_modes=ICdCC_Cl__I_NF_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=160.62,
                    S298=186.01,
                    Cp_values=[96.44, 115.77, 131.34, 143.47, 160.79, 171.46, 184.18],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )
    with pytest.raises(ValidationError):
        # a nitrogen 'R'
        SpeciesBase(smiles='IC=CC(Cl)(I)NF',
                    charge=0,
                    multiplicity=1,
                    coordinates=ICdCC_Cl__I_NF_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    chirality={(5,): 'R', (6,): 'R', (7, 8): 'E'},
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 33] * 33,
                    frequencies=ICdCC_Cl__I_NF_freqs,
                    scaled_projected_frequencies=ICdCC_Cl__I_NF_scaled_freqs,
                    normal_displacement_modes=ICdCC_Cl__I_NF_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=160.62,
                    S298=186.01,
                    Cp_values=[96.44, 115.77, 131.34, 143.47, 160.79, 171.46, 184.18],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 6. conformation_method
    spc_17 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=4,
                         point_group='Td',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_17.conformation_method == 'ARC v1.1.0'
    spc_18 = SpeciesBase(smiles='[H][H]',
                         charge=0,
                         multiplicity=1,
                         coordinates={'symbols': ('H', 'H'), 'isotopes': (1, 1),
                                      'coords': ((0.349, 0.0, 0.0), (-0.349, 0.0, 0.0))},
                         external_symmetry=2,
                         point_group='Dinfh',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 6] * 6,
                         frequencies=[500.2],
                         scaled_projected_frequencies=[495.6],
                         normal_displacement_modes=[[[5, 6, 8]] * 2],
                         freq_id=1,
                         rigid_rotor='linear',
                         rotational_constants=[1],
                         H298=0,
                         S298=130.68,
                         Cp_values=[28.85, 29.18, 19.26, 29.33, 29.63, 30.20, 32.30],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_18.conformation_method is None
    with pytest.raises(ValidationError):
        # no conformation method for a 5-atom species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 6. electronic_energy
    with pytest.raises(ValidationError):
        # no electronic_energy
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 7. E0
    with pytest.raises(ValidationError):
        # no E0
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 8. hessian, frequencies, scaled_projected_frequencies, normal_displacement_modes, and freq_id

    # no hessian, frequencies, scaled_projected_frequencies, normal_displacement_modes, nor freq_id
    # for a monoatomic species
    spc_19 = SpeciesBase(smiles='[H]',
                         charge=0,
                         multiplicity=2,
                         coordinates=h_xyz,
                         external_symmetry=1,
                         point_group='Td',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         freq_id=1,
                         rigid_rotor='atom',
                         H298=218.00,
                         S298=114.72,
                         Cp_values=[20.79, 20.79, 20.79, 20.79, 20.79, 20.79, 20.79],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_19.hessian is None
    assert spc_19.frequencies is None
    assert spc_19.scaled_projected_frequencies is None
    assert spc_19.normal_displacement_modes is None

    spc_20 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=4,
                         point_group='Td',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         )
    assert spc_20.hessian == [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                              [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]]
    assert spc_20.frequencies == ch4_freqs
    assert spc_20.scaled_projected_frequencies == ch4_scaled_freqs
    assert spc_20.normal_displacement_modes == ch4_normal_disp_modes

    with pytest.raises(ValidationError):
        # no hessian given for a polyatomic species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of rows in hessian
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 5] * 8,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of elements per row in hessian
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 4] * 5,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # no frequencies given for a polyatomic species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of frequencies (missing one)
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368],
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of frequencies (extra one)
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368, 1368, 1368],
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of frequencies for a linear species
        SpeciesBase(smiles='[H][H]',
                    charge=0,
                    multiplicity=1,
                    coordinates={'symbols': ('H', 'H'), 'isotopes': (1, 1),
                                 'coords': ((0.349, 0.0, 0.0), (-0.349, 0.0, 0.0))},
                    external_symmetry=2,
                    point_group='Dinfh',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[500.2, 563.5],
                    scaled_projected_frequencies=[500.2 * .97, 563.5 * .97],
                    normal_displacement_modes=[[1, 2, 3], [4, 5, 6]],
                    freq_id=1,
                    rigid_rotor='linear',
                    rotational_constants=[1],
                    H298=0,
                    S298=130.68,
                    Cp_values=[28.85, 29.18, 19.26, 29.33, 29.63, 30.20, 32.30],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # a zero frequency
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368, 0],
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # all real frequencies for a TS species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    is_ts=True,  # TS
                    irc_trajectories=[[ch4_xyz], [ch4_xyz]],
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    irc_paths=['path/to/irc/job.log'],
                    )

    with pytest.raises(ValidationError):
        # no scaled_projected_frequencies given for a polyatomic species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of scaled_projected_frequencies (extra one)
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=[3046 * .99, 1555 * .99, 1555 * .99, 3168 * .99, 3168 * .99,
                                                  3168 * .99, 1368 * .99, 1368 * .99, 1368 * .99, 1368 * .99],
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # a zero scaled_projected_frequencies
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=[3046 * .99, 1555 * .99, 1555 * .99, 3168 * .99, 3168 * .99,
                                                  3168 * .99, 1368 * .99, 1368 * .99, 0],
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # scaled_projected_frequencies identical to frequencies
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # no normal_displacement_modes
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong length of normal_displacement_modes
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=[[1, 2, 3]] * 8,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong length of a single displacement mode
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=[[1, 2, 3]] * 7 + [[1, 2, 3, 4]],
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # no freq_id
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # illegal freq_id
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=-1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 9. rigid_rotor
    assert spc_20.rigid_rotor == 'spherical top'

    with pytest.raises(ValidationError):
        # unrecognized rigid_rotor
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=-1,
                    rigid_rotor='spherical',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 10. statmech_treatment
    assert spc_20.statmech_treatment == 'RRHO'

    with pytest.raises(ValidationError):
        # unrecognized statmech_treatment
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=-1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRRR',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # no statmech_treatment for a polyatomic species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=-1,
                    rigid_rotor='spherical top',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 10. rotational_constants
    assert spc_20.rotational_constants == [1, 2, 3]

    with pytest.raises(ValidationError):
        # no rotational_constants for a non-linear species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=-1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRRR',
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of rotational_constants for a non-linear species
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=-1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRRR',
                    rotational_constants=[1, 2, 3, 4],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of rotational_constants for a linear species
        SpeciesBase(smiles='[H][H]',
                    charge=0,
                    multiplicity=1,
                    coordinates={'symbols': ('H', 'H'), 'isotopes': (1, 1),
                                 'coords': ((0.349, 0.0, 0.0), (-0.349, 0.0, 0.0))},
                    external_symmetry=2,
                    point_group='Dinfh',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[500.2],
                    scaled_projected_frequencies=[500.2 * .97],
                    normal_displacement_modes=[[1, 2, 3]],
                    freq_id=1,
                    rigid_rotor='linear',
                    rotational_constants=[1, 2, 3],
                    H298=0,
                    S298=130.68,
                    Cp_values=[28.85, 29.18, 19.26, 29.33, 29.63, 30.20, 32.30],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # specifying rotational_constants for a mono-atomic species
        SpeciesBase(smiles='[H]',
                    charge=0,
                    multiplicity=2,
                    coordinates=h_xyz,
                    external_symmetry=1,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    freq_id=1,
                    rigid_rotor='atom',
                    rotational_constants=[1],
                    H298=218.00,
                    S298=114.72,
                    Cp_values=[20.79, 20.79, 20.79, 20.79, 20.79, 20.79, 20.79],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 11. torsions
    spc_21_adj = """multiplicity 2
1 O u0 p2 c0 {2,S} {3,S}
2 O u1 p2 c0 {1,S}
3 C u0 p0 c0 {1,S} {4,S} {5,S} {6,S}
4 H u0 p0 c0 {3,S}
5 H u0 p0 c0 {3,S}
6 H u0 p0 c0 {3,S}"""
    spc_21_xyz = {'symbols': ('C', 'O', 'O', 'H', 'H', 'H'),
                  'isotopes': (12, 16, 16, 1, 1, 1),
                  'coords': ((-0.445133, -0.016405, 0.036328), (0.840166, -0.566275, -0.329792),
                             (1.813794, 0.275863, -0.070634), (-0.618754, 0.892203, -0.536074),
                             (-1.173511, -0.783026, -0.215793), (-0.450682, 0.193222, 1.103747))}
    spc_21_freqs = [136.44310609, 494.13102666, 915.7833864, 1131.46788888, 1159.93668632,
                    1225.15219569, 1446.57076992, 1474.81715488, 1485.65281289, 3046.23778037,
                    3134.82050092, 3147.58141696]
    spc_21_scaled_freqs = [477.8194551806087, 885.5618169592619, 1094.1040441328878, 1121.654191498875,
                           1184.7184825643458, 1398.828717361115, 1426.0403040352815, 1436.6159016201818,
                           2945.694361287535, 3031.3401561992705, 3043.6931823367554]
    spc_21_torsions_energies = [0.0, 0.14234410030846326, 0.5440140727049031, 1.1265258497629478,
                                1.783738348815653, 2.402676310881729, 2.8807352015882475,
                                3.141935680524993, 3.1459920778153236, 2.8914026075279304,
                                2.41558326817136, 1.7913890553830099, 1.1260926422411466,
                                0.5344546277038464, 0.13212302940028758, 0.0018142203936680626,
                                0.17184421673269165, 0.6055321598553565, 1.2141755370484497,
                                1.881115513032429, 2.4897693921885145, 2.939407246917927,
                                3.160623988552019, 3.120981566128606, 2.827314155962037,
                                2.324840742076633, 1.694153668151661, 1.0401915378754054,
                                0.47669625628854323, 0.10758773323658105, 0.0028906753686972772,
                                0.18218868617240339, 0.6089348076548465, 1.2021953811829,
                                1.8536606610085213, 2.4575912659483503, 2.91407379880586,
                                3.1536716648741843, 3.133730993451013, 2.86400551648703,
                                2.3842242978801615, 1.7677227996603775, 1.1161314958311273,
                                0.5395428464212831, 0.14239661034728582, 0.0007036339829496212]
    spc_21_data_dict = read_yaml_file(os.path.join(DATA_PATH, 'CH3O2.yml'))
    spc_21 = SpeciesBase(graph=spc_21_adj,
                         charge=0,
                         multiplicity=2,
                         coordinates=spc_21_xyz,
                         external_symmetry=1,
                         point_group='C1',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-190.2915848,
                         E0=-19.64,
                         hessian=spc_21_data_dict['hessian'],
                         frequencies=spc_21_freqs,
                         scaled_projected_frequencies=spc_21_scaled_freqs,
                         normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                         freq_id=1,
                         rigid_rotor='asymmetric top',
                         statmech_treatment='RRHO-1D',
                         rotational_constants=[10.91193, 43.57835, 51.24354],
                         torsions=[{'computation_type': 'continuous constrained optimization',
                                    'dimension': 1,
                                    'symmetry': 3,
                                    'treatment': 'hindered rotor',
                                    'torsions': [4, 1, 2, 3],
                                    'top': [2, 3],
                                    'energies': spc_21_torsions_energies,
                                    'resolution': 8,
                                    'trajectory': spc_21_data_dict['trajectory']}],
                         H298=-7.53,
                         S298=269.89,
                         Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                         )
    assert spc_21.scan_paths == {((4, 1, 2, 3),): 'path/to/scan/job.log'}
    assert spc_21.torsions[0].computation_type == 'continuous constrained optimization'
    assert spc_21.torsions[0].dimension == 1
    assert spc_21.torsions[0].treatment == 'hindered rotor'
    assert spc_21.torsions[0].torsions == [[4, 1, 2, 3]]
    assert spc_21.torsions[0].top == [2, 3]
    assert spc_21.torsions[0].energies[-1] == 0.0007036339829496212
    assert len(spc_21.torsions[0].energies) == 46
    assert spc_21.torsions[0].resolution == [8.0]
    assert spc_21.torsions[0].trajectory[10] == {'coords': ((-0.439581, 0.028533, 0.018813),
                                                            (0.830301, -0.40525, -0.521819),
                                                            (1.846948, 0.081236, 0.151993),
                                                            (-0.82162, 0.845118, -0.592837),
                                                            (-1.104948, -0.816619, -0.143247),
                                                            (-0.34522, 0.262563, 1.074879)),
                                                 'isotopes': (12, 16, 16, 1, 1, 1),
                                                 'symbols': ('C', 'O', 'O', 'H', 'H', 'H')}

    with pytest.raises(ValidationError):
        # not specifying scan_path
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # not specifying torsions.computation_type
    spc_21_b = SpeciesBase(graph=spc_21_adj,
                           charge=0,
                           multiplicity=2,
                           coordinates=spc_21_xyz,
                           external_symmetry=1,
                           point_group='C1',
                           conformation_method='ARC v1.1.0',
                           is_well=True,
                           electronic_energy=-190.2915848,
                           E0=-19.64,
                           hessian=spc_21_data_dict['hessian'],
                           frequencies=spc_21_freqs,
                           scaled_projected_frequencies=spc_21_scaled_freqs,
                           normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                           freq_id=1,
                           rigid_rotor='asymmetric top',
                           statmech_treatment='RRHO-1D',
                           rotational_constants=[10.91193, 43.57835, 51.24354],
                           torsions=[{'dimension': 1,
                                      'symmetry': 3,
                                      'treatment': 'hindered rotor',
                                      'torsions': [4, 1, 2, 3],
                                      'top': [2, 3],
                                      'energies': spc_21_torsions_energies,
                                      'resolution': 8,
                                      'trajectory': spc_21_data_dict['trajectory']}],
                           H298=-7.53,
                           S298=269.89,
                           Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                           Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                           en_corr_id=2,
                           opt_path='path/to/opt/job.log',
                           freq_path='path/to/freq/job.log',
                           sp_path='path/to/sp/job.log',
                           scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                           )
    assert spc_21_b.torsions[0].computation_type == 'continuous constrained optimization'

    with pytest.raises(ValidationError):
        # invalid torsions.computation_type
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'invalid',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.dimension
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 0,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.constraints
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'constraints': {(1,): 15.0,
                                               (0, 2, 5): 68},
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # no torsions.symmetry for a 1D torsion
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # no torsions.treatment
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.treatment
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'invalid',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.torsions: zero-indexed
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 0, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.torsions: short key
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.torsions: wrong dimention
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [[4, 1, 2, 3], [8, 9, 5, 11]],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # no torsions.top
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # zero-indexed torsions.top
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 0],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # wrong torsions.energies dimension
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': [[0.0, 0.14234410030846326, 0.5440140727049031, 1.1265258497629478,
                                            1.783738348815653, 2.402676310881729, 2.8807352015882475,
                                            3.141935680524993, 3.1459920778153236, 2.8914026075279304,
                                            2.41558326817136, 1.7913890553830099, 1.1260926422411466,
                                            0.5344546277038464, 0.13212302940028758, 0.0018142203936680626,
                                            0.17184421673269165, 0.6055321598553565, 1.2141755370484497,
                                            1.881115513032429, 2.4897693921885145, 2.939407246917927,
                                            3.160623988552019, 3.120981566128606, 2.827314155962037,
                                            2.324840742076633, 1.694153668151661, 1.0401915378754054,
                                            0.47669625628854323, 0.10758773323658105, 0.0028906753686972772,
                                            0.18218868617240339, 0.6089348076548465, 1.2021953811829,
                                            1.8536606610085213, 2.4575912659483503, 2.91407379880586,
                                            3.1536716648741843, 3.133730993451013, 2.86400551648703,
                                            2.3842242978801615, 1.7677227996603775, 1.1161314958311273,
                                            0.5395428464212831, 0.14239661034728582, 0.0007036339829496212],
                                            [2]],
                               'resolution': 8,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # invalid torsions.resolution
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 11.1111,
                               'trajectory': spc_21_data_dict['trajectory']}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # no torsions.trajectory
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    with pytest.raises(ValidationError):
        # wrong torsions.trajectory dimention
        SpeciesBase(graph=spc_21_adj,
                    charge=0,
                    multiplicity=2,
                    coordinates=spc_21_xyz,
                    external_symmetry=1,
                    point_group='C1',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-190.2915848,
                    E0=-19.64,
                    hessian=spc_21_data_dict['hessian'],
                    frequencies=spc_21_freqs,
                    scaled_projected_frequencies=spc_21_scaled_freqs,
                    normal_displacement_modes=spc_21_data_dict['normal_displacement_modes'],
                    freq_id=1,
                    rigid_rotor='asymmetric top',
                    statmech_treatment='RRHO-1D',
                    rotational_constants=[10.91193, 43.57835, 51.24354],
                    torsions=[{'computation_type': 'continuous constrained optimization',
                               'dimension': 1,
                               'symmetry': 3,
                               'treatment': 'hindered rotor',
                               'torsions': [4, 1, 2, 3],
                               'top': [2, 3],
                               'energies': spc_21_torsions_energies,
                               'resolution': 8,
                               'trajectory': [spc_21_data_dict['trajectory'], spc_21_data_dict['trajectory']]}],
                    H298=-7.53,
                    S298=269.89,
                    Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                    )

    # 12. conformers
    spc_22 = SpeciesBase(smiles='COO',
                         charge=0,
                         multiplicity=1,
                         coordinates={'symbols': ('O', 'C', 'O', 'O', 'H', 'H', 'H', 'H'),
                                      'isotopes': (16, 12, 16, 16, 1, 1, 1, 1),
                                      'coords': ((0.45442697267484206, -0.4438741163520067, -0.8800505426222011),
                                                 (0.45878696532877977, 0.528166242292718, 0.15258972035741464),
                                                 (1.3195948235766295, 0.13967065136791895, 1.2187293052434112),
                                                 (0.9489896556199436, -1.2313588278819851, 1.5625329109917327),
                                                 (-0.09102351295537717, -1.1651478435014995, -0.52195742071569),
                                                 (0.8273602869184223, 1.4714557436039346, -0.2585620157444454),
                                                 (-0.5581059450328216, 0.6800992247812856, 0.5288624984442329),
                                                 (1.7266834763522185, -1.6502179985439458, 1.1471258903822663))},
                         external_symmetry=1,
                         point_group='C1',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-190.2915848,
                         E0=-19.64,
                         hessian=[[1] * 24] * 24,
                         frequencies=[400] * 18,
                         scaled_projected_frequencies=spc_21_scaled_freqs,
                         normal_displacement_modes=[[[4, 6, 9]] * 8] * 18,
                         freq_id=1,
                         rigid_rotor='asymmetric top',
                         statmech_treatment='RRHO-1D',
                         rotational_constants=[10.91193, 43.57835, 51.24354],
                         conformers=[{'symbols': ('O', 'C', 'O', 'O', 'H', 'H', 'H', 'H'),
                                      'isotopes': (16, 12, 16, 16, 1, 1, 1, 1),
                                      'energy': -0.8462,
                                      'coords': ((0.45442697267484206, -0.4438741163520067, -0.8800505426222011),
                                                 (0.45878696532877977, 0.528166242292718, 0.15258972035741464),
                                                 (1.3195948235766295, 0.13967065136791895, 1.2187293052434112),
                                                 (0.9489896556199436, -1.2313588278819851, 1.5625329109917327),
                                                 (-0.09102351295537717, -1.1651478435014995, -0.52195742071569),
                                                 (0.8273602869184223, 1.4714557436039346, -0.2585620157444454),
                                                 (-0.5581059450328216, 0.6800992247812856, 0.5288624984442329),
                                                 (1.7266834763522185, -1.6502179985439458, 1.1471258903822663))},
                                     {'symbols': ('O', 'C', 'O', 'O', 'H', 'H', 'H', 'H'),
                                      'isotopes': (16, 12, 16, 16, 1, 1, 1, 1),
                                      'energy': -0.2003,
                                      'degeneracy': 2,
                                      'coords': ((0.8587171131284058, -0.4630746209010718, -0.8426356860390303),
                                                 (0.5682194118032847, 0.5176628477338042, 0.14245560508420188),
                                                 (1.6133875890800518, 0.5392283259735404, 1.1082349878893045),
                                                 (2.815008152558939, 0.9643836451950664, 0.3900359334061191),
                                                 (0.5378043925181634, -1.303058517451682, -0.47348458821618994),
                                                 (0.4811586059312696, 1.4981839031244195, -0.33585251821768036),
                                                 (-0.377591087732795, 0.2777036655185814, 0.6368948312612465),
                                                 (2.916068159481999, 0.15430933675559333, -0.14757356062100396))},
                                     ],
                         H298=-7.53,
                         S298=269.89,
                         Cp_values=[52.03, 60.75, 68.85, 76.04, 87.89, 96.90, 110.69, 117.31, 120.40],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500, 2000, 2400],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         scan_paths={((4, 1, 2, 3),): 'path/to/scan/job.log'},
                         )

    # todo stress test conformers


    # 13. H298, S298, Cp_values, Cp_T_list
    assert spc_20.H298 == -74.52
    assert spc_20.S298 == 186.06
    assert spc_20.Cp_values == [36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94]
    assert spc_20.Cp_T_list == [300, 400, 500, 600, 800, 1000, 1500]

    # not specifying 298, S298, Cp_values, Cp_T_list for a TS
    SpeciesBase(smiles='C',
                charge=0,
                multiplicity=1,
                coordinates=ch4_xyz,
                external_symmetry=4,
                point_group='Td',
                conformation_method='ARC v1.1.0',
                is_well=True,
                is_ts=True,  # TS
                irc_trajectories=[[ch4_xyz], [ch4_xyz]],
                electronic_energy=-365.544,
                E0=-370.240,
                hessian=[[1] * 15] * 15,
                frequencies=[-3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368, 1368],
                scaled_projected_frequencies=ch4_scaled_freqs,
                normal_displacement_modes=ch4_normal_disp_modes,
                freq_id=1,
                rigid_rotor='spherical top',
                statmech_treatment='RRHO',
                rotational_constants=[1, 2, 3],
                opt_path='path/to/opt/job.log',
                freq_path='path/to/freq/job.log',
                sp_path='path/to/sp/job.log',
                irc_paths=['path/to/forward/irc/job.log', 'path/to/reverse/irc/job.log'],
                )

    with pytest.raises(ValidationError):
        # not specifying H298
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # not specifying S298
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # not specifying Cp_values
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # not specifying Cp_T_list
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # length mismatch between Cp_values and Cp_T_list
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    # 14. paths
    assert spc_20.opt_path == 'path/to/opt/job.log'
    assert spc_20.freq_path == 'path/to/freq/job.log'
    assert spc_20.sp_path == 'path/to/sp/job.log'

    with pytest.raises(ValidationError):
        # not specifying opt_path
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # not specifying freq_path
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # not specifying sp_path
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    )

    with pytest.raises(ValidationError):
        # not specifying irc_path for a TS
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    is_ts=True,  # TS
                    irc_trajectories=[[ch4_xyz], [ch4_xyz]],
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[-3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368, 1368],
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    )

    with pytest.raises(ValidationError):
        # wrong number of irc_path for a TS
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    is_ts=True,  # TS
                    irc_trajectories=[[ch4_xyz], [ch4_xyz]],
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=[-3046, 1555, 1555, 3168, 3168, 3168, 1368, 1368, 1368],
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    irc_paths=['path/to/forward/irc/job.log', 'path/to/reverse/irc/job.log',
                               'path/to/third/irc/job.log'],
                    )

    # 15. unconverged_jobs, extras
    spc_23 = SpeciesBase(smiles='C',
                         charge=0,
                         multiplicity=1,
                         coordinates=ch4_xyz,
                         external_symmetry=4,
                         point_group='Td',
                         conformation_method='ARC v1.1.0',
                         is_well=True,
                         electronic_energy=-365.544,
                         E0=-370.240,
                         hessian=[[1] * 15] * 15,
                         frequencies=ch4_freqs,
                         scaled_projected_frequencies=ch4_scaled_freqs,
                         normal_displacement_modes=ch4_normal_disp_modes,
                         freq_id=1,
                         rigid_rotor='spherical top',
                         statmech_treatment='RRHO',
                         rotational_constants=[1, 2, 3],
                         H298=-74.52,
                         S298=186.06,
                         Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                         Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                         en_corr_id=2,
                         opt_path='path/to/opt/job.log',
                         freq_path='path/to/freq/job.log',
                         sp_path='path/to/sp/job.log',
                         unconverged_jobs=[{'job type': 'sp',
                                            'issue': 'SCF',
                                            'troubleshooting': 'keyword',
                                            'comment': 'txt',
                                            'path': 'path/to/failed/sp/job.log'}],
                         extras={'key1': 'val1',
                                 'key2': ['v', 'v']},
                         )
    assert spc_23.unconverged_jobs == [{'job type': 'sp',
                                        'issue': 'SCF',
                                        'troubleshooting': 'keyword',
                                        'comment': 'txt',
                                        'path': 'path/to/failed/sp/job.log'}]
    assert spc_23.extras == {'key1': 'val1',
                             'key2': ['v', 'v']}

    with pytest.raises(ValidationError):
        # illegal key in unconverged_jobs
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    unconverged_jobs=[{'job_type': 'sp',
                                       'issue': 'SCF',
                                       'troubleshooting': 'keyword',
                                       'extra': 'txt',
                                       'path': 'path/to/failed/sp/job.log'}]
                    )

    with pytest.raises(ValidationError):
        # no job type in unconverged_jobs
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    unconverged_jobs=[{'issue': 'SCF',
                                       'troubleshooting': 'keyword',
                                       'comment': 'txt',
                                       'path': 'path/to/failed/sp/job.log'}]
                    )

    with pytest.raises(ValidationError):
        # no path in unconverged_jobs
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    unconverged_jobs=[{'job_type': 'sp',
                                       'issue': 'SCF',
                                       'troubleshooting': 'keyword',
                                       'comment': 'txt'}]
                    )

    with pytest.raises(ValidationError):
        # invalid job type in unconverged_jobs
        SpeciesBase(smiles='C',
                    charge=0,
                    multiplicity=1,
                    coordinates=ch4_xyz,
                    external_symmetry=4,
                    point_group='Td',
                    conformation_method='ARC v1.1.0',
                    is_well=True,
                    electronic_energy=-365.544,
                    E0=-370.240,
                    hessian=[[1] * 15] * 15,
                    frequencies=ch4_freqs,
                    scaled_projected_frequencies=ch4_scaled_freqs,
                    normal_displacement_modes=ch4_normal_disp_modes,
                    freq_id=1,
                    rigid_rotor='spherical top',
                    statmech_treatment='RRHO',
                    rotational_constants=[1, 2, 3],
                    H298=-74.52,
                    S298=186.06,
                    Cp_values=[36.07, 40.38, 45.77, 51.63, 62.30, 71.00, 85.94],
                    Cp_T_list=[300, 400, 500, 600, 800, 1000, 1500],
                    en_corr_id=2,
                    opt_path='path/to/opt/job.log',
                    freq_path='path/to/freq/job.log',
                    sp_path='path/to/sp/job.log',
                    unconverged_jobs=[{'job_type': 'other',
                                       'issue': 'SCF',
                                       'troubleshooting': 'keyword',
                                       'comment': 'txt',
                                       'path': 'path/to/failed/sp/job.log'}]
                    )
