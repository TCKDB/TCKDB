"""
TCKDB backend app tests models test_author module
"""

import tckdb.backend.app.conversions.converter as converter

test_set = {'smiles': ['[NH]C1=NC=NC(N)N1',
                       '[NH]C1=NCNC(=N)N1',
                       '[NH]C1=NC=NC(N)=N1',
                       '[NH2]',
                       '[CH2]',
                       'C1=CC=C2C=CC=CC2=C1',
                       'COC(=O)CC(OC1OCC(O)C(OC)C1)CC(OC1OCCC(N(C)C)C(O)1)C(O)C',
                       'CCC=CC(=O)O',
                       'CCC(S)C(C)C(CF)CCl',
                       ],
            'inchi': ['InChI=1S/C3H6N5/c4-2-6-1-7-3(5)8-2/h1-2,5H,4H2,(H,6,7,8)',
                      'InChI=1S/C3H6N5/c4-2-6-1-7-3(5)8-2/h4H,1H2,(H3,5,6,7,8)',
                      'InChI=1S/C3H4N5/c4-2-6-1-7-3(5)8-2/h1,4H,(H2,5,6,7,8)',
                      'InChI=1S/H2N/h1H2',
                      'InChI=1S/CH2/h1H2',
                      'InChI=1S/C10H8/c1-2-6-10-8-4-3-7-9(10)5-1/h1-8H',
                      'InChI=1S/C21H39NO10/c1-12(23)16(32-21-20(26)14(22(2)3)6-7-29-21)8-13(9-18(25)28-5)31-19-10-17(27-4)15(24)11-30-19/h12-17,19-21,23-24,26H,6-11H2,1-5H3',
                      'InChI=1S/C5H8O2/c1-2-3-4-5(6)7/h3-4H,2H2,1H3,(H,6,7)',
                      'InChI=1S/C8H16ClFS/c1-3-8(11)6(2)7(4-9)5-10/h6-8,11H,3-5H2,1-2H3',
                      ],
            'inchi key': ['PEHWMAIOUBOBRI-UHFFFAOYSA-N',
                          'VELKHMSCCIDPQF-UHFFFAOYSA-N',
                          'DRYXKVSIBNYBOY-UHFFFAOYSA-N',
                          'MDFFNEOEWAXZRQ-UHFFFAOYSA-N',
                          'HZVOZRGWRWCICA-UHFFFAOYSA-N',
                          'UFWIBTONFRDIAS-UHFFFAOYSA-N',
                          'NPVACFVAOZFTGC-UHFFFAOYSA-N',
                          'YIYBQIKDCADOSF-UHFFFAOYSA-N',
                          'PXOLZRNDFGGLHD-UHFFFAOYSA-N',
                          ],
            'adjlist': ["""multiplicity 2
1  N u1 p1 c0 {2,S} {3,S}
2  H u0 p0 c0 {1,S}
3  C u0 p0 c0 {1,S} {4,D} {9,S}
4  N u0 p1 c0 {3,D} {5,S}
5  C u0 p0 c0 {4,S} {6,D} {10,S}
6  N u0 p1 c0 {5,D} {7,S}
7  C u0 p0 c0 {6,S} {8,S} {9,S} {11,S}
8  N u0 p1 c0 {7,S} {12,S} {13,S}
9  N u0 p1 c0 {3,S} {7,S} {14,S}
10 H u0 p0 c0 {5,S}
11 H u0 p0 c0 {7,S}
12 H u0 p0 c0 {8,S}
13 H u0 p0 c0 {8,S}
14 H u0 p0 c0 {9,S}
""",
                        """multiplicity 2
1  N u1 p1 c0 {2,S} {3,S}
2  H u0 p0 c0 {1,S}
3  C u0 p0 c0 {1,S} {4,D} {9,S}
4  N u0 p1 c0 {3,D} {5,S}
5  C u0 p0 c0 {4,S} {6,S} {10,S} {11,S}
6  N u0 p1 c0 {5,S} {7,S} {12,S}
7  C u0 p0 c0 {6,S} {8,D} {9,S}
8  N u0 p1 c0 {7,D} {13,S}
9  N u0 p1 c0 {3,S} {7,S} {14,S}
10 H u0 p0 c0 {5,S}
11 H u0 p0 c0 {5,S}
12 H u0 p0 c0 {6,S}
13 H u0 p0 c0 {8,S}
14 H u0 p0 c0 {9,S}
""",
                        """multiplicity 2
1  N u1 p1 c0 {2,S} {3,S}
2  H u0 p0 c0 {1,S}
3  C u0 p0 c0 {1,S} {4,D} {9,S}
4  N u0 p1 c0 {3,D} {5,S}
5  C u0 p0 c0 {4,S} {6,D} {10,S}
6  N u0 p1 c0 {5,D} {7,S}
7  C u0 p0 c0 {6,S} {8,S} {9,D}
8  N u0 p1 c0 {7,S} {11,S} {12,S}
9  N u0 p1 c0 {3,S} {7,D}
10 H u0 p0 c0 {5,S}
11 H u0 p0 c0 {8,S}
12 H u0 p0 c0 {8,S}
""",
                        """multiplicity 2
1 N u1 p1 c0 {2,S} {3,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
""",
                        """multiplicity 3
1 C u2 p0 c0 {2,S} {3,S}
2 H u0 p0 c0 {1,S}
3 H u0 p0 c0 {1,S}
""",
                        """1  C u0 p0 c0 {2,D} {10,S} {11,S}
2  C u0 p0 c0 {1,D} {3,S} {12,S}
3  C u0 p0 c0 {2,S} {4,D} {13,S}
4  C u0 p0 c0 {3,D} {5,S} {9,S}
5  C u0 p0 c0 {4,S} {6,D} {14,S}
6  C u0 p0 c0 {5,D} {7,S} {15,S}
7  C u0 p0 c0 {6,S} {8,D} {16,S}
8  C u0 p0 c0 {7,D} {9,S} {17,S}
9  C u0 p0 c0 {4,S} {8,S} {10,D}
10 C u0 p0 c0 {1,S} {9,D} {18,S}
11 H u0 p0 c0 {1,S}
12 H u0 p0 c0 {2,S}
13 H u0 p0 c0 {3,S}
14 H u0 p0 c0 {5,S}
15 H u0 p0 c0 {6,S}
16 H u0 p0 c0 {7,S}
17 H u0 p0 c0 {8,S}
18 H u0 p0 c0 {10,S}
""",
                        """1  C u0 p0 c0 {2,S} {33,S} {34,S} {35,S}
2  O u0 p2 c0 {1,S} {3,S}
3  C u0 p0 c0 {2,S} {4,D} {5,S}
4  O u0 p2 c0 {3,D}
5  C u0 p0 c0 {3,S} {6,S} {36,S} {37,S}
6  C u0 p0 c0 {5,S} {7,S} {17,S} {38,S}
7  O u0 p2 c0 {6,S} {8,S}
8  C u0 p0 c0 {7,S} {9,S} {16,S} {39,S}
9  O u0 p2 c0 {8,S} {10,S}
10 C u0 p0 c0 {9,S} {11,S} {40,S} {41,S}
11 C u0 p0 c0 {10,S} {12,S} {13,S} {42,S}
12 O u0 p2 c0 {11,S} {43,S}
13 C u0 p0 c0 {11,S} {14,S} {16,S} {44,S}
14 O u0 p2 c0 {13,S} {15,S}
15 C u0 p0 c0 {14,S} {45,S} {46,S} {47,S}
16 C u0 p0 c0 {8,S} {13,S} {48,S} {49,S}
17 C u0 p0 c0 {6,S} {18,S} {50,S} {51,S}
18 C u0 p0 c0 {17,S} {19,S} {30,S} {52,S}
19 O u0 p2 c0 {18,S} {20,S}
20 C u0 p0 c0 {19,S} {21,S} {28,S} {53,S}
21 O u0 p2 c0 {20,S} {22,S}
22 C u0 p0 c0 {21,S} {23,S} {54,S} {55,S}
23 C u0 p0 c0 {22,S} {24,S} {56,S} {57,S}
24 C u0 p0 c0 {23,S} {25,S} {28,S} {58,S}
25 N u0 p1 c0 {24,S} {26,S} {27,S}
26 C u0 p0 c0 {25,S} {59,S} {60,S} {61,S}
27 C u0 p0 c0 {25,S} {62,S} {63,S} {64,S}
28 C u0 p0 c0 {20,S} {24,S} {29,S} {65,S}
29 O u0 p2 c0 {28,S} {66,S}
30 C u0 p0 c0 {18,S} {31,S} {32,S} {67,S}
31 O u0 p2 c0 {30,S} {68,S}
32 C u0 p0 c0 {30,S} {69,S} {70,S} {71,S}
33 H u0 p0 c0 {1,S}
34 H u0 p0 c0 {1,S}
35 H u0 p0 c0 {1,S}
36 H u0 p0 c0 {5,S}
37 H u0 p0 c0 {5,S}
38 H u0 p0 c0 {6,S}
39 H u0 p0 c0 {8,S}
40 H u0 p0 c0 {10,S}
41 H u0 p0 c0 {10,S}
42 H u0 p0 c0 {11,S}
43 H u0 p0 c0 {12,S}
44 H u0 p0 c0 {13,S}
45 H u0 p0 c0 {15,S}
46 H u0 p0 c0 {15,S}
47 H u0 p0 c0 {15,S}
48 H u0 p0 c0 {16,S}
49 H u0 p0 c0 {16,S}
50 H u0 p0 c0 {17,S}
51 H u0 p0 c0 {17,S}
52 H u0 p0 c0 {18,S}
53 H u0 p0 c0 {20,S}
54 H u0 p0 c0 {22,S}
55 H u0 p0 c0 {22,S}
56 H u0 p0 c0 {23,S}
57 H u0 p0 c0 {23,S}
58 H u0 p0 c0 {24,S}
59 H u0 p0 c0 {26,S}
60 H u0 p0 c0 {26,S}
61 H u0 p0 c0 {26,S}
62 H u0 p0 c0 {27,S}
63 H u0 p0 c0 {27,S}
64 H u0 p0 c0 {27,S}
65 H u0 p0 c0 {28,S}
66 H u0 p0 c0 {29,S}
67 H u0 p0 c0 {30,S}
68 H u0 p0 c0 {31,S}
69 H u0 p0 c0 {32,S}
70 H u0 p0 c0 {32,S}
71 H u0 p0 c0 {32,S}
""",
                        """1  C u0 p0 c0 {2,S} {8,S} {9,S} {10,S}
2  C u0 p0 c0 {1,S} {3,S} {11,S} {12,S}
3  C u0 p0 c0 {2,S} {4,D} {13,S}
4  C u0 p0 c0 {3,D} {5,S} {14,S}
5  C u0 p0 c0 {4,S} {6,D} {7,S}
6  O u0 p2 c0 {5,D}
7  O u0 p2 c0 {5,S} {15,S}
8  H u0 p0 c0 {1,S}
9  H u0 p0 c0 {1,S}
10 H u0 p0 c0 {1,S}
11 H u0 p0 c0 {2,S}
12 H u0 p0 c0 {2,S}
13 H u0 p0 c0 {3,S}
14 H u0 p0 c0 {4,S}
15 H u0 p0 c0 {7,S}
""",
                        """1  C  u0 p0 c0 {2,S} {12,S} {13,S} {14,S}
2  C  u0 p0 c0 {1,S} {3,S} {15,S} {16,S}
3  C  u0 p0 c0 {2,S} {4,S} {5,S} {17,S}
4  S  u0 p2 c0 {3,S} {18,S}
5  C  u0 p0 c0 {3,S} {6,S} {7,S} {19,S}
6  C  u0 p0 c0 {5,S} {20,S} {21,S} {22,S}
7  C  u0 p0 c0 {5,S} {8,S} {10,S} {23,S}
8  C  u0 p0 c0 {7,S} {9,S} {24,S} {25,S}
9  F  u0 p3 c0 {8,S}
10 C  u0 p0 c0 {7,S} {11,S} {26,S} {27,S}
11 Cl u0 p3 c0 {10,S}
12 H  u0 p0 c0 {1,S}
13 H  u0 p0 c0 {1,S}
14 H  u0 p0 c0 {1,S}
15 H  u0 p0 c0 {2,S}
16 H  u0 p0 c0 {2,S}
17 H  u0 p0 c0 {3,S}
18 H  u0 p0 c0 {4,S}
19 H  u0 p0 c0 {5,S}
20 H  u0 p0 c0 {6,S}
21 H  u0 p0 c0 {6,S}
22 H  u0 p0 c0 {6,S}
23 H  u0 p0 c0 {7,S}
24 H  u0 p0 c0 {8,S}
25 H  u0 p0 c0 {8,S}
26 H  u0 p0 c0 {10,S}
27 H  u0 p0 c0 {10,S}
""",
                        ]}

xyz_1 = {'str': """C       0.00000000    0.00000000    0.00000000
H       0.63003260    0.63003260    0.63003260
H      -0.63003260   -0.63003260    0.63003260
H      -0.63003260    0.63003260   -0.63003260
H       0.63003260   -0.63003260   -0.63003260""",  # no line break at the end on purpose
         'dict': {'symbols': ('C', 'H', 'H', 'H', 'H'),
                  'isotopes': (12, 1, 1, 1, 1),
                  'coords': ((0.0, 0.0, 0.0),
                             (0.6300326, 0.6300326, 0.6300326),
                             (-0.6300326, -0.6300326, 0.6300326),
                             (-0.6300326, 0.6300326, -0.6300326),
                             (0.6300326, -0.6300326, -0.6300326))},
         }

xyz_2 = {'str': """S       1.02558264   -0.04344404   -0.07343859
O      -0.25448248    1.10710477    0.18359696
N      -1.30762173    0.15796567   -0.10489290
C      -0.49011438   -1.03704380    0.15365747
H      -0.64869950   -1.85796321   -0.54773423
H      -0.60359153   -1.37304859    1.18613964
H      -1.43009127    0.23517346   -1.11797908""",  # extra line breaks added on purpose
         'str mod': """S       1.02558264   -0.04344404   -0.07343859
O      -0.25448248    1.10710477    0.18359696
N      -1.30762173    0.15796567   -0.10489290
C      -0.49011438   -1.03704380    0.15365747
H      -0.64869950   -1.85796321   -0.54773423
H      -0.60359153   -1.37304859    1.18613964
H      -1.43009127    0.23517346   -1.11797908


""",  # extra line breaks added on purpose
         'dict': {'symbols': ('S', 'O', 'N', 'C', 'H', 'H', 'H'),
                  'isotopes': (32, 16, 14, 12, 1, 1, 1),
                  'coords': ((1.02558264, -0.04344404, -0.07343859),
                             (-0.25448248, 1.10710477, 0.18359696),
                             (-1.30762173, 0.15796567, -0.1048929),
                             (-0.49011438, -1.0370438, 0.15365747),
                             (-0.6486995, -1.85796321, -0.54773423),
                             (-0.60359153, -1.37304859, 1.18613964),
                             (-1.43009127, 0.23517346, -1.11797908))},
         }

xyz_3 = {'str': """O      -0.25448248    1.10710477    0.18359696
N      -1.30762173    0.15796567   -0.10489290
C      -0.49011438   -1.03704380    0.15365747
H      -0.64869950   -1.85796321   -0.54773423
H      -0.60359153   -1.37304859    1.18613964
S       1.02558264   -0.04344404   -0.07343859
H      -1.43009127    0.23517346   -1.11797908""",
         'str iso': """O      -0.25448248    1.10710477    0.18359696
N      -1.30762173    0.15796567   -0.10489290
C(Iso=13)        -0.49011438   -1.03704380    0.15365747
H(Iso=2)         -0.64869950   -1.85796321   -0.54773423
H      -0.60359153   -1.37304859    1.18613964
S       1.02558264   -0.04344404   -0.07343859
H      -1.43009127    0.23517346   -1.11797908""",
         'dict': {'symbols': ('O', 'N', 'C', 'H', 'H', 'S', 'H'),
                  'isotopes': (16, 14, 13, 2, 1, 32, 1),
                  'coords': ((-0.25448248, 1.10710477, 0.18359696),
                             (-1.30762173, 0.15796567, -0.1048929),
                             (-0.49011438, -1.0370438, 0.15365747),
                             (-0.6486995, -1.85796321, -0.54773423),
                             (-0.60359153, -1.37304859, 1.18613964),
                             (1.02558264, -0.04344404, -0.07343859),
                             (-1.43009127, 0.23517346, -1.11797908))},
         }

xyz_4 = {'str': """B       0.00000000    0.00000000    0.00000000
Br      0.00000000    1.91555700    0.00000000
Br      1.65892100   -0.95777800    0.00000000
Br     -1.65892100   -0.95777800    0.00000000""",
         'str mod': """B 0.0000000 0.0000000 0.0000000
Br 0.0000000 1.9155570 0.0000000
Br 1.6589210 -0.9577780 0.0000000
Br -1.6589210	-0.9577780	    0.0000000   
""",  # last line contains tabs
         'dict': {'symbols': ('B', 'Br', 'Br', 'Br'),
                  'isotopes': (11, 79, 79, 79),
                  'coords': ((0.0, 0.0, 0.0),
                             (0.0, 1.915557, 0.0),
                             (1.658921, -0.957778, 0.0),
                             (-1.658921, -0.957778, 0.0))}}

xyz_5 = {'str': """O       1.17464110   -0.15309781    0.00000000
N       0.06304988    0.35149648    0.00000000
C      -1.12708952   -0.11333971    0.00000000
H      -1.93800144    0.60171738    0.00000000
H      -1.29769464   -1.18742971    0.00000000""",
         'dict': {'symbols': ('O', 'N', 'C', 'H', 'H'),
                  'isotopes': (16, 14, 12, 1, 1),
                  'coords': ((1.1746411, -0.15309781, 0.0),
                             (0.06304988, 0.35149648, 0.0),
                             (-1.12708952, -0.11333971, 0.0),
                             (-1.93800144, 0.60171738, 0.0),
                             (-1.29769464, -1.18742971, 0.0))}}

xyz_6 = {'str': """S      -0.06618943   -0.12360663   -0.07631983
O      -0.79539707    0.86755487    1.02675668
O      -0.68919931    0.25421823   -1.34830853
N       0.01546439   -1.54297548    0.44580391
C       1.59721519    0.47861334    0.00711000
H       1.94428095    0.40772394    1.03719428
H       2.20318015   -0.14715186   -0.64755729
H       1.59252246    1.51178950   -0.33908352
H      -0.87856890   -2.02453514    0.38494433
H      -1.34135876    1.49608206    0.53295071""",
         'dict': {'symbols': ('S', 'O', 'O', 'N', 'C', 'H', 'H', 'H', 'H', 'H'),
                  'isotopes': (32, 16, 16, 14, 12, 1, 1, 1, 1, 1),
                  'coords': ((-0.06618943, -0.12360663, -0.07631983),
                             (-0.79539707, 0.86755487, 1.02675668),
                             (-0.68919931, 0.25421823, -1.34830853),
                             (0.01546439, -1.54297548, 0.44580391),
                             (1.59721519, 0.47861334, 0.00711),
                             (1.94428095, 0.40772394, 1.03719428),
                             (2.20318015, -0.14715186, -0.64755729),
                             (1.59252246, 1.5117895, -0.33908352),
                             (-0.8785689, -2.02453514, 0.38494433),
                             (-1.34135876, 1.49608206, 0.53295071))}}

xyz_7 = {'str': """O       2.64631000   -0.59546000    0.29327900
O       2.64275300    2.05718500   -0.72942300
C       1.71639100    1.97990400    0.33793200
C      -3.48200000    1.50082200    0.03091100
C      -3.85550400   -1.05695100   -0.03598300
C       3.23017500   -1.88003900    0.34527100
C      -2.91846400    0.11144600    0.02829400
C       0.76935400    0.80820200    0.23396500
C      -1.51123800   -0.09830700    0.09199100
C       1.28495500   -0.50051800    0.22531700
C      -0.59550400    0.98573400    0.16444900
C      -0.94480400   -1.39242500    0.08331900
C       0.42608700   -1.59172200    0.14650400
H       2.24536500    1.93452800    1.29979800
H       1.14735500    2.91082400    0.31665700
H      -3.24115200    2.03800800    0.95768700
H      -3.08546100    2.10616100   -0.79369800
H      -4.56858900    1.48636200   -0.06630800
H      -4.89652000   -0.73067200   -0.04282300
H      -3.69325500   -1.65970000   -0.93924100
H      -3.72742500   -1.73294900    0.81894100
H       3.02442400   -2.44854700   -0.56812500
H       4.30341500   -1.72127600    0.43646000
H       2.87318600   -2.44236600    1.21464900
H      -0.97434200    2.00182800    0.16800300
H      -1.58581300   -2.26344700    0.02264400
H       0.81122400   -2.60336100    0.13267800
H       3.16280800    1.25020800   -0.70346900""",
         'dict': {'symbols': ('O', 'O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'H',
                              'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H'),
                  'isotopes': (16, 16, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 1,
                               1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                  'coords': ((2.64631, -0.59546, 0.293279), (2.642753, 2.057185, -0.729423),
                             (1.716391, 1.979904, 0.337932), (-3.482, 1.500822, 0.030911),
                             (-3.855504, -1.056951, -0.035983), (3.230175, -1.880039, 0.345271),
                             (-2.918464, 0.111446, 0.028294), (0.769354, 0.808202, 0.233965),
                             (-1.511238, -0.098307, 0.091991), (1.284955, -0.500518, 0.225317),
                             (-0.595504, 0.985734, 0.164449), (-0.944804, -1.392425, 0.083319),
                             (0.426087, -1.591722, 0.146504), (2.245365, 1.934528, 1.299798),
                             (1.147355, 2.910824, 0.316657), (-3.241152, 2.038008, 0.957687),
                             (-3.085461, 2.106161, -0.793698), (-4.568589, 1.486362, -0.066308),
                             (-4.89652, -0.730672, -0.042823), (-3.693255, -1.6597, -0.939241),
                             (-3.727425, -1.732949, 0.818941), (3.024424, -2.448547, -0.568125),
                             (4.303415, -1.721276, 0.43646), (2.873186, -2.442366, 1.214649),
                             (-0.974342, 2.001828, 0.168003), (-1.585813, -2.263447, 0.022644),
                             (0.811224, -2.603361, 0.132678), (3.162808, 1.250208, -0.703469))}}

xyz_8 = {'str': """N      -1.19974408   -0.16100521    0.02747383
H      -1.40166244   -0.62296955   -0.84870341
H      -0.00000188    1.28610828    0.59260779
N       0.00000085    0.56510729   -0.11246215
H      -1.12946922   -0.87090783    0.75375189
N       1.19976130   -0.16099805    0.02746049
H       1.12947958   -0.87089986    0.75374444
H       1.40152747   -0.62305927   -0.84870587""",
         'dict': {'symbols': ('N', 'H', 'H', 'N', 'H', 'N', 'H', 'H'),
                  'isotopes': (14, 1, 1, 14, 1, 14, 1, 1),
                  'coords': ((-1.19974408, -0.16100521, 0.02747383),
                             (-1.40166244, -0.62296955, -0.84870341),
                             (-1.88e-06, 1.28610828, 0.59260779),
                             (8.5e-07, 0.56510729, -0.11246215),
                             (-1.12946922, -0.87090783, 0.75375189),
                             (1.1997613, -0.16099805, 0.02746049),
                             (1.12947958, -0.87089986, 0.75374444),
                             (1.40152747, -0.62305927, -0.84870587))}}

xyz_9 = {'str': """O       3.13231900    0.76911100   -0.08086900
O       3.38743600   -2.11675900   -0.03858500
C      -2.36919300   -0.54695600    0.56682700
C      -3.15360600    0.17105900    1.66307400
C      -2.72802700   -2.02644500    0.45926800
C       2.33156000   -1.73423500   -0.92148100
C       3.65011300    2.04916900    0.27583500
C      -0.93121600   -0.18690000    0.42819300
C       1.35285800   -0.75515100   -0.30846400
C       1.79433800    0.52230200    0.09841000
C       0.01159300   -1.07956000   -0.13549700
C      -0.44828900    1.08210200    0.80429800
C       0.89316900    1.43644300    0.64990400
H      -2.89113500   -0.05394500   -0.49913900
H       2.74879900   -1.31147200   -1.84752800
H       1.80991500   -2.65831900   -1.18214800
H      -3.11220800    1.25882600    1.56763000
H      -4.20773200   -0.11655100    1.61916700
H      -2.76884700   -0.09784700    2.65693400
H      -2.29498600   -2.59841700    1.29217500
H      -3.81389700   -2.15150400    0.49848800
H      -2.38217200   -2.47865600   -0.47430600
H       3.52516600    2.24195700    1.34780100
H       4.71260700    2.01840000    0.03253700
H       3.16623600    2.84537400   -0.30166300
H      -0.30596000   -2.07000300   -0.44289400
H      -1.12238100    1.81600000    1.22939200
H       1.21751200    2.42129300    0.96452300
H       3.88922100   -1.31541600    0.16697100
O      -3.43304800    0.46172100   -1.53075600
O      -2.89487900    1.76177800   -1.59155700
H      -2.12457300    1.65249500   -2.17600500""",
         'dict': {'symbols': ('O', 'O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C',
                              'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H',
                              'H', 'H', 'H', 'O', 'O', 'H'),
                  'isotopes': (16, 16, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                               1, 1, 1, 1, 1, 1, 1, 16, 16, 1),
                  'coords': ((3.132319, 0.769111, -0.080869),
                             (3.387436, -2.116759, -0.038585),
                             (-2.369193, -0.546956, 0.566827),
                             (-3.153606, 0.171059, 1.663074),
                             (-2.728027, -2.026445, 0.459268),
                             (2.33156, -1.734235, -0.921481),
                             (3.650113, 2.049169, 0.275835),
                             (-0.931216, -0.1869, 0.428193),
                             (1.352858, -0.755151, -0.308464),
                             (1.794338, 0.522302, 0.09841),
                             (0.011593, -1.07956, -0.135497),
                             (-0.448289, 1.082102, 0.804298),
                             (0.893169, 1.436443, 0.649904),
                             (-2.891135, -0.053945, -0.499139),
                             (2.748799, -1.311472, -1.847528),
                             (1.809915, -2.658319, -1.182148),
                             (-3.112208, 1.258826, 1.56763),
                             (-4.207732, -0.116551, 1.619167),
                             (-2.768847, -0.097847, 2.656934),
                             (-2.294986, -2.598417, 1.292175),
                             (-3.813897, -2.151504, 0.498488),
                             (-2.382172, -2.478656, -0.474306),
                             (3.525166, 2.241957, 1.347801),
                             (4.712607, 2.0184, 0.032537),
                             (3.166236, 2.845374, -0.301663),
                             (-0.30596, -2.070003, -0.442894),
                             (-1.122381, 1.816, 1.229392),
                             (1.217512, 2.421293, 0.964523),
                             (3.889221, -1.315416, 0.166971),
                             (-3.433048, 0.461721, -1.530756),
                             (-2.894879, 1.761778, -1.591557),
                             (-2.124573, 1.652495, -2.176005))},
         'gaussian': """1          8           0        3.132319    0.769111   -0.080869
              2          8           0        3.387436   -2.116759   -0.038585
              3          6           0       -2.369193   -0.546956    0.566827
              4          6           0       -3.153606    0.171059    1.663074
              5          6           0       -2.728027   -2.026445    0.459268
              6          6           0        2.331560   -1.734235   -0.921481
              7          6           0        3.650113    2.049169    0.275835
              8          6           0       -0.931216   -0.186900    0.428193
              9          6           0        1.352858   -0.755151   -0.308464
             10          6           0        1.794338    0.522302    0.098410
             11          6           0        0.011593   -1.079560   -0.135497
             12          6           0       -0.448289    1.082102    0.804298
             13          6           0        0.893169    1.436443    0.649904
             14          1           0       -2.891135   -0.053945   -0.499139
             15          1           0        2.748799   -1.311472   -1.847528
             16          1           0        1.809915   -2.658319   -1.182148
             17          1           0       -3.112208    1.258826    1.567630
             18          1           0       -4.207732   -0.116551    1.619167
             19          1           0       -2.768847   -0.097847    2.656934
             20          1           0       -2.294986   -2.598417    1.292175
             21          1           0       -3.813897   -2.151504    0.498488
             22          1           0       -2.382172   -2.478656   -0.474306
             23          1           0        3.525166    2.241957    1.347801
             24          1           0        4.712607    2.018400    0.032537
             25          1           0        3.166236    2.845374   -0.301663
             26          1           0       -0.305960   -2.070003   -0.442894
             27          1           0       -1.122381    1.816000    1.229392
             28          1           0        1.217512    2.421293    0.964523
             29          1           0        3.889221   -1.315416    0.166971
             30          8           0       -3.433048    0.461721   -1.530756
             31          8           0       -2.894879    1.761778   -1.591557
             32          1           0       -2.124573    1.652495   -2.176005""",
         }

xyz_10 = {'str': """S       0.35915171    1.99254721    1.18490490
O       0.40385373   -0.65769862    1.03431374
O      -1.23178399   -0.59559801   -1.39114493
O       0.69015560   -1.65712867    0.01239391
C      -0.04261360    0.49595776    0.40364219
C      -0.80103934    0.51314044   -0.70610325
H      -1.17387862    1.41490429   -1.17716515
H       0.95726719    1.46882836    2.26423536
H      -0.83008868   -1.36939497   -0.94170868
H       1.65888059   -1.54205855    0.02674995""",
          'dict': {'symbols': ('S', 'O', 'O', 'O', 'C', 'C', 'H', 'H', 'H', 'H'),
                   'isotopes': (32, 16, 16, 16, 12, 12, 1, 1, 1, 1),
                   'coords': ((0.35915171, 1.99254721, 1.1849049),
                              (0.40385373, -0.65769862, 1.03431374),
                              (-1.23178399, -0.59559801, -1.39114493),
                              (0.6901556, -1.65712867, 0.01239391),
                              (-0.0426136, 0.49595776, 0.40364219),
                              (-0.80103934, 0.51314044, -0.70610325),
                              (-1.17387862, 1.41490429, -1.17716515),
                              (0.95726719, 1.46882836, 2.26423536),
                              (-0.83008868, -1.36939497, -0.94170868),
                              (1.65888059, -1.54205855, 0.02674995))}}


def test_inchi_from_smiles():
    """Test getting an InChI descriptor from a SMILES descriptor"""
    for inchi, smiles in zip(test_set['inchi'], test_set['smiles']):
        assert inchi == converter.inchi_from_smiles(smiles)


def test_inchi_from_inchi_key():
    """Test getting an InChI descriptor from an InChI Key descriptor"""
    for i, (inchi, inchi_key) in enumerate(zip(test_set['inchi'], test_set['inchi key'])):
        if i not in [0, 1, 6, 8]:
            # skipping InChI Keys for which this online conversion is unsuccessful
            assert inchi == converter.inchi_from_inchi_key(inchi_key)


def test_inchi_key_from_inchi():
    """Test getting an InChI Key descriptor from an InChI descriptor"""
    for inchi_key, inchi in zip(test_set['inchi key'], test_set['inchi']):
        assert inchi_key == converter.inchi_key_from_inchi(inchi)


def test_adjlist_from_smiles():
    """Test getting an adjacency list from a SMILES descriptor"""
    for adjlist, smiles in zip(test_set['adjlist'], test_set['smiles']):
        assert adjlist == converter.adjlist_from_smiles(smiles)


def test_smiles_and_inchi_from_adjlist():
    """Test getting a SMILES and an InChI descriptors from an adjacency list"""
    for smiles_1, inchi_1, adjlist in zip(test_set['smiles'], test_set['inchi'], test_set['adjlist']):
        smiles_2, inchi_2 = converter.smiles_and_inchi_from_adjlist(adjlist)
        assert converter.inchi_from_smiles(smiles_1) == converter.inchi_from_smiles(
            smiles_2)  # compare the derived InChI instead of SMILES
        assert inchi_1 == inchi_2


def test_smiles_from_inchi():
    """Test getting an InChI Key descriptor from an InChI descriptor"""
    for smiles, inchi in zip(test_set['smiles'], test_set['inchi']):
        assert inchi == converter.inchi_from_smiles(smiles)  # compare the derived InChI instead of SMILES


def test_add_common_isotopes_to_coords():
    """Test adding common isotopes to coords"""
    coords = {'symbols': ('N', 'H', 'H', 'N', 'H', 'N', 'H', 'H'),
              'coords': ((-1.1997440839, -0.1610052059, 0.0274738287),
                         (-1.4016624407, -0.6229695533, -0.848703408),
                         (-1.8759e-06, 1.2861082773, 0.592607787),
                         (8.52e-07, 0.5651072858, -0.1124621525),
                         (-1.1294692206, -0.8709078271, 0.7537518889),
                         (1.1997613019, -0.1609980472, 0.0274604887),
                         (1.1294795781, -0.870899855, 0.7537444446),
                         (1.4015274689, -0.6230592706, -0.8487058662))}
    converter.add_common_isotopes_to_coords(coords)
    assert coords['isotopes'] == (14, 1, 1, 14, 1, 14, 1, 1)


def test_str_to_xyz():
    """Test converting a string xyz format to the xyz dictionary"""
    xyz_dict_1 = converter.str_to_xyz(xyz_str=xyz_1['str'])
    xyz_dict_2 = converter.str_to_xyz(xyz_str=xyz_2['str mod'])
    xyz_dict_3 = converter.str_to_xyz(xyz_str=xyz_3['str iso'])
    xyz_dict_4 = converter.str_to_xyz(xyz_str=xyz_4['str mod'])
    xyz_dict_5 = converter.str_to_xyz(xyz_str=xyz_5['str'])
    xyz_dict_6 = converter.str_to_xyz(xyz_str=xyz_6['str'])
    xyz_dict_7 = converter.str_to_xyz(xyz_str=xyz_7['str'])
    xyz_dict_8 = converter.str_to_xyz(xyz_str=xyz_8['str'])
    xyz_dict_9a = converter.str_to_xyz(xyz_str=xyz_9['str'])
    xyz_dict_9b = converter.str_to_xyz(xyz_str=xyz_9['gaussian'])  # check parsing a Gaussian output format
    xyz_dict_10 = converter.str_to_xyz(xyz_str=xyz_10['str'])
    assert xyz_dict_1 == xyz_1['dict']
    assert xyz_dict_2 == xyz_2['dict']
    assert xyz_dict_3 == xyz_3['dict']
    assert xyz_dict_4 == xyz_4['dict']
    assert xyz_dict_5 == xyz_5['dict']
    assert xyz_dict_6 == xyz_6['dict']
    assert xyz_dict_7 == xyz_7['dict']
    assert xyz_dict_8 == xyz_8['dict']
    assert xyz_dict_9a == xyz_9['dict']
    assert xyz_dict_9b == xyz_9['dict']
    assert xyz_dict_10 == xyz_10['dict']

    # test processing commas in string input
    xyz_from_commas = converter.str_to_xyz(""" O,-3.77205932,0.72922606,-1.43980481
 H,-4.73205932,0.72922606,-1.43980481
 H,-3.45160473,-0.17570977,-1.43980481""")
    expected_xyz = {'symbols': ('O', 'H', 'H'), 'isotopes': (16, 1, 1),
                    'coords': ((-3.77205932, 0.72922606, -1.43980481),
                               (-4.73205932, 0.72922606, -1.43980481),
                               (-3.45160473, -0.17570977, -1.43980481))}
    assert xyz_from_commas == expected_xyz


def test_xyz_to_str():
    """Test converting a xyz dictionary to a string format"""
    xyz_str_1 = converter.xyz_to_str(xyz_dict=xyz_1['dict'])
    xyz_str_2 = converter.xyz_to_str(xyz_dict=xyz_2['dict'])
    xyz_str_3a = converter.xyz_to_str(xyz_dict=xyz_3['dict'])
    xyz_str_3b = converter.xyz_to_str(xyz_dict=xyz_3['dict'], isotope_format='gaussian')
    xyz_str_4 = converter.xyz_to_str(xyz_dict=xyz_4['dict'])
    xyz_str_5 = converter.xyz_to_str(xyz_dict=xyz_5['dict'])
    xyz_str_6 = converter.xyz_to_str(xyz_dict=xyz_6['dict'])
    xyz_str_7 = converter.xyz_to_str(xyz_dict=xyz_7['dict'])
    xyz_str_8 = converter.xyz_to_str(xyz_dict=xyz_8['dict'])
    xyz_str_9a = converter.xyz_to_str(xyz_dict=xyz_9['dict'])
    xyz_str_9b = converter.xyz_to_str(xyz_dict=xyz_9['dict'])
    xyz_str_10 = converter.xyz_to_str(xyz_dict=xyz_10['dict'])
    assert xyz_str_1 == xyz_1['str']
    assert xyz_str_2 == xyz_2['str']
    assert xyz_str_3a == xyz_3['str']
    assert xyz_str_3b == xyz_3['str iso']
    assert xyz_str_4 == xyz_4['str']
    assert xyz_str_5 == xyz_5['str']
    assert xyz_str_6 == xyz_6['str']
    assert xyz_str_7 == xyz_7['str']
    assert xyz_str_8 == xyz_8['str']
    assert xyz_str_9a == xyz_9['str']
    assert xyz_str_9b == xyz_9['str']
    assert xyz_str_10 == xyz_10['str']
